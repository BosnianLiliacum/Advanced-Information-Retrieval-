Post Title: mDNS-Repeater Docker Container Issue
Author: rick043
Score: 2
URL: https://www.reddit.com/r/selfhosted/comments/1e9dahd/mdnsrepeater_docker_container_issue/
Number of comments: 10
Created UTC: 2024-07-22 12:40:08

Post Content:
Hi everyone,

I'm currently running an mDNS-repeater in a Docker container (monstrenyatko/mdns-repeater), but I keep encountering the same error message:

    mdns-repeater: send setsockopt(SO_BINDTODEVICE): No such device 
    mdns-repeater: unable to create socket for interface eth0 
    mdns-repeater: exit.

I don't have a lot of networking knowledge, but this problem has me stumped. It wasn't always like this, it worked fine a few months ago. I'm using this setup to facilitate mDNS communication with a Home Assistant container, and it works without issues on my personal server.

However, when I set this up on a Raspberry Pi 5 at my parents' house, it stopped working after a few months. I've searched extensively online but haven't found a solution.

Here is the output of `ip a` on the Raspberry Pi:

    1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
        link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
        inet 127.0.0.1/8 scope host lo
           valid_lft forever preferred_lft forever
        inet6 ::1/128 scope host noprefixroute 
           valid_lft forever preferred_lft forever
    2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
        link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
        inet 192.168.1.253/24 brd 192.168.1.255 scope global dynamic noprefixroute eth0
           valid_lft 84438sec preferred_lft 84438sec
        inet6 fe80::2171:3f1:df66:9e47/64 scope link noprefixroute 
           valid_lft forever preferred_lft forever
    3: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
        link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
        inet 192.168.1.176/24 brd 192.168.1.255 scope global dynamic noprefixroute wlan0
           valid_lft 84548sec preferred_lft 84548sec
        inet6 fe80::ab05:df73:d49f:b0d5/64 scope link noprefixroute 
           valid_lft forever preferred_lft forever
    4: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default 
        link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
        inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
           valid_lft forever preferred_lft forever

Any insights or suggestions would be greatly appreciated!

Thanks in advance!

Top 1 comments:
Comment 1:
  Author: Sroundez
  Comment: Does the container have "host" network access, rather than docker container networking?

    [15:16:00 root@add ~ {0}]# export MDNS_REPEATER_INTERFACES="eth0 docker0"
    [15:16:10 root@add ~ {0}]# docker compose up
    WARN[0000] The "DOCKER_REGISTRY" variable is not set. Defaulting to a blank string. 
    WARN[0000] /root/docker-compose.yml: `version` is obsolete 
    [+] Running 1/0
     âœ” Container mdns-repeater  Recreated                                                                     0.0s 
    Attaching to mdns-repeater
    mdns-repeater  | + update_user_gid daemon daemon
    mdns-repeater  | + _USERNAME=daemon
    mdns-repeater  | + _GROUPNAME=daemon
    mdns-repeater  | + _GID=
    mdns-repeater  | + '[' -n '' ']'
    mdns-repeater  | + update_user_uid daemon
    mdns-repeater  | + _USERNAME=daemon
    mdns-repeater  | + _UID=
    mdns-repeater  | + '[' -n '' ']'
    mdns-repeater  | + '[' mdns-repeater-app = mdns-repeater-app ']'
    mdns-repeater  | + shift
    mdns-repeater  | + exec /scripts/app-entrypoint.sh /bin/mdns-repeater -f eth0 docker0
    mdns-repeater  | + set -e
    mdns-repeater  | + : daemon
    mdns-repeater  | ++ id -u
    mdns-repeater  | ++ id -u daemon
    mdns-repeater  | + [[ 0 != \2 ]]
    mdns-repeater  | + '[' -n daemon ']'
    mdns-repeater  | + exec su-exec daemon:daemon /scripts/app-entrypoint.sh /bin/mdns-repeater -f eth0 docker0
    mdns-repeater  | + set -e
    mdns-repeater  | + : daemon
    mdns-repeater  | ++ id -u
    mdns-repeater  | ++ id -u daemon
    mdns-repeater  | + [[ 2 != \2 ]]
    mdns-repeater  | + [[ -n daemon ]]
    mdns-repeater  | ++ id -g
    mdns-repeater  | ++ getent group daemon
    mdns-repeater  | ++ cut -d: -f3
    mdns-repeater  | + [[ 2 != \2 ]]
    mdns-repeater  | + exec /bin/mdns-repeater -f eth0 docker0


Can you post the full results of your `docker compose up`?
  Score: 1
  Created UTC: 2024-07-22 15:14:45

Note: This post has only 1 comments at the time of scraping.
